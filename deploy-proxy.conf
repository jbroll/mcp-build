#!/bin/bash
# MCP Build Reverse Proxy Configuration
# Deploys to build.rkroll.com to proxy to symon.rkroll.com:3344
# https://github.com/jbroll/deploy.sh

# =============================================================================
# Global Configuration
# =============================================================================

export APP_NAME="mcp-build-proxy"
export DOMAIN_NAME="build.rkroll.com"
export REMOTE_HOST="build.rkroll.com"
export REMOTE_USER="john"

# =============================================================================
# Deployment Modules
# =============================================================================

export DEPLOY_TYPES="reverse_proxy"

# =============================================================================
# Reverse Proxy Configuration
# =============================================================================

# Target service (symon.rkroll.com on custom HTTPS port 3344)
export REVERSE_PROXY_TARGET_HOST="symon.rkroll.com"
export REVERSE_PROXY_TARGET_PORT="3344"
export REVERSE_PROXY_TARGET_PROTOCOL="https"

# Disable SSL verification for backend (symon may use self-signed cert on port 3344)
# Set to "yes" if symon has a valid certificate for port 3344
export REVERSE_PROXY_SSL_VERIFY="no"

# Local Apache configuration (standard ports on build.rkroll.com)
export REVERSE_PROXY_HTTP_PORT="80"
export REVERSE_PROXY_HTTPS_PORT="443"

# LetsEncrypt configuration
export REVERSE_PROXY_LETSENCRYPT_EMAIL="john@rkroll.com"

# Enable security headers
export REVERSE_PROXY_SECURITY_HEADERS="yes"

# =============================================================================
# Deployment Instructions
# =============================================================================
#
# Initial deployment (sets up Apache, LetsEncrypt, and reverse proxy):
#   cd /home/john/src/mcp-build
#   DEPLOY_SH_CONF=./deploy-proxy.conf ../deploy.sh/deploy.sh init
#
# Update deployment (reconfigures reverse proxy):
#   cd /home/john/src/mcp-build
#   DEPLOY_SH_CONF=./deploy-proxy.conf ../deploy.sh/deploy.sh update
#
# After deployment:
#   - Access service via: https://build.rkroll.com
#   - All traffic proxied to: https://symon.rkroll.com:3344
#
# =============================================================================
